package com.erdal.service;

import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

import com.erdal.common.PaymentDTO;
import com.erdal.common.TransactionRequest;
import com.erdal.domain.Order;
import com.erdal.repository.OrderRepository;

import ch.qos.logback.core.joran.conditional.IfAction;
import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class OrderService {

	private final OrderRepository orderRepository;

	private RestTemplate restTemplate;

	public Order saveOrder(TransactionRequest transactionRequest) {
		Order order = transactionRequest.getOrder();
		PaymentDTO payment = transactionRequest.getPaymentDTO();
		payment.setAmount(order.getPrice());

		// rest call
		PaymentDTO paymentResponse = restTemplate.postForObject("http://localhost:9191/payment/doPayment", payment,
				PaymentDTO.class);
		
		 paymentResponse.getPaymentStatus().equals("succes")?order "payment prossesing succesfull"
		orderRepository.save(order);
		return null;
	}

}
